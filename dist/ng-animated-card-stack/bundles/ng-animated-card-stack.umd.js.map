{"version":3,"file":"ng-animated-card-stack.umd.js.map","sources":["ng://ng-animated-card-stack/lib/services/animated-stack.service.ts","ng://ng-animated-card-stack/lib/components/animated-card/animated-card.component.ts","ng://ng-animated-card-stack/lib/components/animated-stack/animated-stack.component.ts","ng://ng-animated-card-stack/lib/animated-card-stack.module.ts"],"sourcesContent":["import { Injectable } from '@angular/core';\r\nimport { Subject, of } from 'rxjs';\r\nimport { delay, tap } from 'rxjs/operators';\r\n\r\n@Injectable()\r\nexport class AnimatedStackService {\r\n  private _destroy$ = new Subject<string>();\r\n  destroy$ = this._destroy$.asObservable();\r\n  private _destroyed$ = new Subject<string>();\r\n  destroyed$ = this._destroyed$.asObservable();\r\n\r\n  constructor() { }\r\n\r\n  destroy(id: string, delayTime: number) {\r\n    this._destroy$.next(id);\r\n    return of(id).pipe(\r\n      delay(delayTime),\r\n      tap(_ => this._destroyed$.next(id))\r\n    );\r\n  }\r\n}\r\n","import { AfterViewInit, ChangeDetectionStrategy, Component, ElementRef, Input, Renderer2 } from '@angular/core';\r\nimport { AnimatedStackService } from '../../services/animated-stack.service';\r\n\r\n\r\n@Component({\r\n  selector: 'x-animated-card',\r\n  templateUrl: './animated-card.component.html',\r\n  styleUrls: ['./animated-card.component.scss'],\r\n  changeDetection: ChangeDetectionStrategy.OnPush\r\n})\r\nexport class AnimatedCardComponent implements AfterViewInit {\r\n  /** index of the item in the list */\r\n  @Input() id: string;\r\n  delay = 400;\r\n  deleted: boolean;\r\n\r\n  constructor(\r\n    private stackSrv: AnimatedStackService,\r\n    private elemRef: ElementRef,\r\n    private renderer: Renderer2\r\n  ) { }\r\n\r\n  ngAfterViewInit() {\r\n    this.renderer.setStyle(this.elemRef.nativeElement, 'transition', `${this.delay}ms transform`);\r\n  }\r\n\r\n  destroy() {\r\n    this.renderer.setStyle(this.elemRef.nativeElement, 'visibility', 'hidden');\r\n    return this.stackSrv.destroy(this.id, this.delay);\r\n  }\r\n\r\n  getPosition() {\r\n    return (this.elemRef.nativeElement as HTMLElement).getBoundingClientRect();\r\n  }\r\n\r\n  getElement() {\r\n    return this.elemRef.nativeElement;\r\n  }\r\n\r\n}\r\n","import {\r\n  AfterViewInit,\r\n  ChangeDetectionStrategy,\r\n  Component,\r\n  ContentChildren,\r\n  ElementRef,\r\n  QueryList,\r\n  Renderer2,\r\n} from '@angular/core';\r\nimport { AnimatedCardComponent } from '../animated-card/animated-card.component';\r\nimport { AnimatedStackService } from '../../services/animated-stack.service';\r\n\r\n/**\r\n * animated component ðð±âðð¢ð¥ð¥\r\n */\r\n@Component({\r\n  selector: 'x-animated-stack',\r\n  templateUrl: './animated-stack.component.html',\r\n  styleUrls: ['./animated-stack.component.scss'],\r\n  changeDetection: ChangeDetectionStrategy.OnPush,\r\n  providers: [AnimatedStackService]\r\n})\r\nexport class AnimatedStackComponent implements AfterViewInit {\r\n  @ContentChildren(AnimatedCardComponent) cards: QueryList<AnimatedCardComponent>;\r\n\r\n  constructor(\r\n    private stackSrv: AnimatedStackService,\r\n    private renderer: Renderer2,\r\n    private elemRef: ElementRef\r\n  ) { }\r\n\r\n  ngAfterViewInit() {\r\n    // when a card has been destroyed we get its index\r\n    this.stackSrv.destroy$.subscribe(id => {\r\n      // getting the non deleted elements\r\n      const cardArray = this.cards.map(card => card)\r\n        .filter(card => !card.deleted);\r\n      const index = cardArray.findIndex(card => card.id === id);\r\n      for (let i = index + 1; i < cardArray.length; i++) {\r\n        // we now need to modify next card\r\n        const card = cardArray[i];\r\n        const lastCoords = cardArray[i - 1].getPosition();\r\n        const currentCoords = card.getPosition();\r\n        this.applyTranslation(card.getElement(), lastCoords, currentCoords);\r\n      }\r\n    });\r\n\r\n    // we need to reset the translation after changes\r\n    this.stackSrv.destroyed$.subscribe(id => {\r\n      const cardArray = this.cards.map(card => card);\r\n      const index = cardArray.findIndex(card => card.id === id);\r\n      const deletedCard = cardArray[index];\r\n      const cardElem = deletedCard.getElement();\r\n      deletedCard.deleted = true;\r\n      this.renderer.setStyle(cardElem, 'display', 'none');\r\n\r\n      for (let i = index + 1; i < cardArray.length; i++) {\r\n        // we reset styles\r\n        const nextElem = cardArray[i].getElement();\r\n        this.renderer.setStyle(nextElem, 'transform', 'none');\r\n        this.renderer.setStyle(nextElem, 'transition', 'none');\r\n      }\r\n    });\r\n  }\r\n\r\n  applyTranslation(elem, lastCoords, currentCoords) {\r\n    const dx = lastCoords.x - currentCoords.x;\r\n    const dy = lastCoords.y - currentCoords.y;\r\n    this.renderer.setStyle(elem, 'transition', '300ms transform');\r\n    this.renderer.setStyle(elem, 'transform', `translate3d(${dx}px, ${dy}px, 0)`);\r\n  }\r\n\r\n}\r\n\r\n","import { NgModule } from '@angular/core';\nimport { AnimatedStackComponent } from './components/animated-stack/animated-stack.component';\nimport { AnimatedCardComponent } from './components/animated-card/animated-card.component';\n\n@NgModule({\n  imports: [],\n  declarations: [AnimatedStackComponent, AnimatedCardComponent],\n  exports: [AnimatedStackComponent, AnimatedCardComponent]\n})\nexport class AnimatedCardStackModule { }\n"],"names":["Subject","of","delay","tap","Injectable","Component","ChangeDetectionStrategy","ElementRef","Renderer2","Input","ContentChildren","NgModule"],"mappings":";;;;;;;;;;AAAA;QAWE;YALQ,cAAS,GAAG,IAAIA,YAAO,EAAU,CAAC;YAC1C,aAAQ,GAAG,IAAI,CAAC,SAAS,CAAC,YAAY,EAAE,CAAC;YACjC,gBAAW,GAAG,IAAIA,YAAO,EAAU,CAAC;YAC5C,eAAU,GAAG,IAAI,CAAC,WAAW,CAAC,YAAY,EAAE,CAAC;SAE5B;;;;;;QAEjB,sCAAO;;;;;YAAP,UAAQ,EAAU,EAAE,SAAiB;gBAArC,iBAMC;gBALC,IAAI,CAAC,SAAS,CAAC,IAAI,CAAC,EAAE,CAAC,CAAC;gBACxB,OAAOC,OAAE,CAAC,EAAE,CAAC,CAAC,IAAI,CAChBC,eAAK,CAAC,SAAS,CAAC,EAChBC,aAAG,CAAC,UAAA,CAAC,IAAI,OAAA,KAAI,CAAC,WAAW,CAAC,IAAI,CAAC,EAAE,CAAC,GAAA,CAAC,CACpC,CAAC;aACH;;oBAfFC,eAAU;;;;QAgBX,2BAAC;KAhBD;;;;;;ACJA;QAgBE,+BACU,QAA8B,EAC9B,OAAmB,EACnB,QAAmB;YAFnB,aAAQ,GAAR,QAAQ,CAAsB;YAC9B,YAAO,GAAP,OAAO,CAAY;YACnB,aAAQ,GAAR,QAAQ,CAAW;YAN7B,UAAK,GAAG,GAAG,CAAC;SAOP;;;;QAEL,+CAAe;;;YAAf;gBACE,IAAI,CAAC,QAAQ,CAAC,QAAQ,CAAC,IAAI,CAAC,OAAO,CAAC,aAAa,EAAE,YAAY,EAAK,IAAI,CAAC,KAAK,iBAAc,CAAC,CAAC;aAC/F;;;;QAED,uCAAO;;;YAAP;gBACE,IAAI,CAAC,QAAQ,CAAC,QAAQ,CAAC,IAAI,CAAC,OAAO,CAAC,aAAa,EAAE,YAAY,EAAE,QAAQ,CAAC,CAAC;gBAC3E,OAAO,IAAI,CAAC,QAAQ,CAAC,OAAO,CAAC,IAAI,CAAC,EAAE,EAAE,IAAI,CAAC,KAAK,CAAC,CAAC;aACnD;;;;QAED,2CAAW;;;YAAX;gBACE,OAAO,oBAAC,IAAI,CAAC,OAAO,CAAC,aAAa,IAAiB,qBAAqB,EAAE,CAAC;aAC5E;;;;QAED,0CAAU;;;YAAV;gBACE,OAAO,IAAI,CAAC,OAAO,CAAC,aAAa,CAAC;aACnC;;oBAjCFC,cAAS,SAAC;wBACT,QAAQ,EAAE,iBAAiB;wBAC3B,qCAA6C;wBAE7C,eAAe,EAAEC,4BAAuB,CAAC,MAAM;;qBAChD;;;;;wBARQ,oBAAoB;wBAD+BC,eAAU;wBAASC,cAAS;;;;yBAYrFC,UAAK;;QA2BR,4BAAC;KAnCD;;;;;;ACJA;;;AAeA;QAUE,gCACU,QAA8B,EAC9B,QAAmB,EACnB,OAAmB;YAFnB,aAAQ,GAAR,QAAQ,CAAsB;YAC9B,aAAQ,GAAR,QAAQ,CAAW;YACnB,YAAO,GAAP,OAAO,CAAY;SACxB;;;;QAEL,gDAAe;;;YAAf;gBAAA,iBAgCC;;gBA9BC,IAAI,CAAC,QAAQ,CAAC,QAAQ,CAAC,SAAS,CAAC,UAAA,EAAE;;;wBAE3B,SAAS,GAAG,KAAI,CAAC,KAAK,CAAC,GAAG,CAAC,UAAA,IAAI,IAAI,OAAA,IAAI,GAAA,CAAC;yBAC3C,MAAM,CAAC,UAAA,IAAI,IAAI,OAAA,CAAC,IAAI,CAAC,OAAO,GAAA,CAAC;;wBAC1B,KAAK,GAAG,SAAS,CAAC,SAAS,CAAC,UAAA,IAAI,IAAI,OAAA,IAAI,CAAC,EAAE,KAAK,EAAE,GAAA,CAAC;oBACzD,KAAK,IAAI,CAAC,GAAG,KAAK,GAAG,CAAC,EAAE,CAAC,GAAG,SAAS,CAAC,MAAM,EAAE,CAAC,EAAE,EAAE;;;4BAE3C,IAAI,GAAG,SAAS,CAAC,CAAC,CAAC;;4BACnB,UAAU,GAAG,SAAS,CAAC,CAAC,GAAG,CAAC,CAAC,CAAC,WAAW,EAAE;;4BAC3C,aAAa,GAAG,IAAI,CAAC,WAAW,EAAE;wBACxC,KAAI,CAAC,gBAAgB,CAAC,IAAI,CAAC,UAAU,EAAE,EAAE,UAAU,EAAE,aAAa,CAAC,CAAC;qBACrE;iBACF,CAAC,CAAC;;gBAGH,IAAI,CAAC,QAAQ,CAAC,UAAU,CAAC,SAAS,CAAC,UAAA,EAAE;;wBAC7B,SAAS,GAAG,KAAI,CAAC,KAAK,CAAC,GAAG,CAAC,UAAA,IAAI,IAAI,OAAA,IAAI,GAAA,CAAC;;wBACxC,KAAK,GAAG,SAAS,CAAC,SAAS,CAAC,UAAA,IAAI,IAAI,OAAA,IAAI,CAAC,EAAE,KAAK,EAAE,GAAA,CAAC;;wBACnD,WAAW,GAAG,SAAS,CAAC,KAAK,CAAC;;wBAC9B,QAAQ,GAAG,WAAW,CAAC,UAAU,EAAE;oBACzC,WAAW,CAAC,OAAO,GAAG,IAAI,CAAC;oBAC3B,KAAI,CAAC,QAAQ,CAAC,QAAQ,CAAC,QAAQ,EAAE,SAAS,EAAE,MAAM,CAAC,CAAC;oBAEpD,KAAK,IAAI,CAAC,GAAG,KAAK,GAAG,CAAC,EAAE,CAAC,GAAG,SAAS,CAAC,MAAM,EAAE,CAAC,EAAE,EAAE;;;4BAE3C,QAAQ,GAAG,SAAS,CAAC,CAAC,CAAC,CAAC,UAAU,EAAE;wBAC1C,KAAI,CAAC,QAAQ,CAAC,QAAQ,CAAC,QAAQ,EAAE,WAAW,EAAE,MAAM,CAAC,CAAC;wBACtD,KAAI,CAAC,QAAQ,CAAC,QAAQ,CAAC,QAAQ,EAAE,YAAY,EAAE,MAAM,CAAC,CAAC;qBACxD;iBACF,CAAC,CAAC;aACJ;;;;;;;QAED,iDAAgB;;;;;;YAAhB,UAAiB,IAAI,EAAE,UAAU,EAAE,aAAa;;oBACxC,EAAE,GAAG,UAAU,CAAC,CAAC,GAAG,aAAa,CAAC,CAAC;;oBACnC,EAAE,GAAG,UAAU,CAAC,CAAC,GAAG,aAAa,CAAC,CAAC;gBACzC,IAAI,CAAC,QAAQ,CAAC,QAAQ,CAAC,IAAI,EAAE,YAAY,EAAE,iBAAiB,CAAC,CAAC;gBAC9D,IAAI,CAAC,QAAQ,CAAC,QAAQ,CAAC,IAAI,EAAE,WAAW,EAAE,iBAAe,EAAE,YAAO,EAAE,WAAQ,CAAC,CAAC;aAC/E;;oBAvDFJ,cAAS,SAAC;wBACT,QAAQ,EAAE,kBAAkB;wBAC5B,gEAA8C;wBAE9C,eAAe,EAAEC,4BAAuB,CAAC,MAAM;wBAC/C,SAAS,EAAE,CAAC,oBAAoB,CAAC;;qBAClC;;;;;wBAXQ,oBAAoB;wBAH3BE,cAAS;wBAFTD,eAAU;;;;4BAkBTG,oBAAe,SAAC,qBAAqB;;QAiDxC,6BAAC;KAzDD;;;;;;ACfA;QAIA;SAKwC;;oBALvCC,aAAQ,SAAC;wBACR,OAAO,EAAE,EAAE;wBACX,YAAY,EAAE,CAAC,sBAAsB,EAAE,qBAAqB,CAAC;wBAC7D,OAAO,EAAE,CAAC,sBAAsB,EAAE,qBAAqB,CAAC;qBACzD;;QACsC,8BAAC;KALxC;;;;;;;;;;;;;;;;;;;;;;;;;"}
